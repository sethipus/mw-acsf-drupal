{% set search_filter_container_base_class = 'search-filter-container' %}
{% set search_filter_block_base_class = 'search-filter-block' %}
{% set search_filter_header_base_class = 'search-filter-header' %}
{% set search_filter_content_base_class = 'search-filter-content' %}
{% set search_filter_footer_base_class = 'search-filter-footer' %}
{% set search_filter_information_base_class = 'search-filter-info' %}
{% set modifier = applied_filters_list|length ? '' : 'hidden' %}
{{ attach_library('emulsifymars/card-grid-filter') }}

<div {{ bem(search_filter_container_base_class) }} data-theme="{{ theme_styles }}">
  {% if search_form is not empty %}
    <div {{ bem('search', [], search_filter_container_base_class, ['search-input-wrapper', 'mars-search-form']) }}>
      <div class="search-input">
        {{ search_form }}
      </div>
      <div class="mars-search-autocomplete-suggestions-wrapper">
        <div class="autocomplete-border"></div>
        <div class="mars-suggestions">
          {% include "@atoms/lists/ul.twig" with {
            ul_items: search_results,
          } %}
        </div>
      </div>
    </div>
  {% endif %}
  {% if filters is not empty %}
  <div class="search-filter-open-button">{{ 'Filter' | mt }}</div>
  <div {{ bem(search_filter_block_base_class) }}>
    <div {{ bem(search_filter_header_base_class) }}>
      <div {{ bem('title', [], search_filter_header_base_class) }}>{{ title }}</div>
      <div {{ bem('close', [], search_filter_header_base_class) }}></div>
    </div>
    <div {{ bem(search_filter_content_base_class) }}>
      {% for filter in filters %}
        {% include "@molecules/filter/filter.twig" with {
          filter_title: filter.filter_title,
          filter_id: filter.filter_id,
          active_filters_count: filter.active_filters_count,
          checkboxes: filter.checkboxes,
          filter_title_transform: filter_title_transform
        } %}
      {% endfor %}
    </div>
    <div {{ bem(search_filter_footer_base_class) }}>
      <a href="#" {{ bem('button', ['clear-all'], search_filter_block_base_class) }}>{{ "Clear All" | mt }}</a>
      <a href="#" {{ bem('button', ['highlighted', 'apply', 'disabled'], search_filter_block_base_class) }}>{{ "Apply" | mt }}</a>
    </div>
  </div>
  <div {{ bem(search_filter_information_base_class, [modifier]) }}>
    <div {{ bem('applied', [modifier], search_filter_information_base_class) }}>
      <div {{ bem('applied-label', [], search_filter_information_base_class) }}>
        {{ "Applied filters (" | mt }}<span {{ bem('applied-count', [], search_filter_information_base_class) }}>{{ applied_filters_list|length }}</span>{{ "):" | mt }}
      </div>
      <ul {{ bem('applied-text', [], search_filter_information_base_class) }}>
        {% for item in applied_filters_list %}
          <li {{ bem('applied-name', [], search_filter_information_base_class) }}>
            <span>{{ item.title }}</span>
            <button data-id="{{ item.key }}" {{ bem('applied-clear', [], search_filter_information_base_class) }} aria-label="{{ ('remove ' ~ item.title) | mt }}"></button>
          </li>
        {% endfor %}
      </ul>
    </div>
    <div {{ bem('clear', [], search_filter_information_base_class) }}>
      <button {{ bem('button', ['simple', 'clear-all', modifier], search_filter_block_base_class) }}>{{ "Clear All" | mt }}</button>
    </div>
  </div>
{% endif %}
</div>

