{#
 # Available variables:
 # - card__image__src - the actual image file location.
 # - card__image__alt - (optional) the alt text for screen readers and when the image cannot load.
 # - card__image__output_image_tag - whether to print the picture element or not.
 #
 # - card__content__base_class - base classname of the copy wrapper - defaults to 'heading'.
 # - card__content__modifiers - array of modifiers to add to the base classname of the copy wrapper.
 # - card__content__blockname - blockname prepended to the base classname of the copy wrapper.
 #
 # - card__eyebrow - the eyebrow for current card.
 #
 # - card__heading - the content of the title component.
 # - card__heading__link - (optional) the url the title should link to. Defaults to card__link__url.
 # - card__heading__base_class - base classname of the title component. Defaults to "title".
 # - card__heading__blockname - blockname to add to the base classname of the title - defaults to card__base_class.
 # - card__heading__modifiers - array of modifiers to add to the base classname of the title.
 # - card__heading__link_base_class - base class to add to the title link - defaults to 'title-link'.
 #
 # - card__subheading - the content of the subtitle component.
 # - card__subheading__link - (optional) the url the subtitle should link to.
 # - card__subheading__base_class - base classname of the subtitle component. Defaults to "subtitle".
 # - card__subheading__modifiers - array of modifiers to add to the base classname of the subtitle.
 #
 # - card__body - the content of the body component.
 # - card__body__base_class - base classname of the body component. Defaults to "body".
 # - card__body__modifiers - array of modifiers to add to the base classname of the body.
 #
 # - card__link__text - the content of the link component.
 # - card__link__url - the url the link should link to.
 # - card__link__base_class - base classname of the link component. Defaults to "link".
 # - card__link__blockname - override link blockname. Defaults to card__base_class.
 # - card__link__attributes - array of attribute,value pairs for the link attribute.
 # - card__link__modifiers - array of modifiers to add to the base classname of the link.
 #
 # - card__button__content - the content of the button component.
 # - card__button__url - the url the button should link to.
 # - card__button__base_class - base classname of the button component. Defaults to "button".
 # - card__button__attributes - array of attribute,value pairs for the button attribute.
 # - card__button__modifiers - array of modifiers to add to the base classname of the button.
 #}
{% set card__base_class = 'card' %}
{% set card__image__output_image_tag = true %}
{% if card__image__size == '16:9' %}
  {% set image_size = 'image-size-large' %}
  {% set images = {
    1440: card__image__src|resizeWithGravity(433, 244),
    768: card__image__src|resizeWithGravity(334, 188),
    375: card__image__src|resizeWithGravity(335, 244),
  } %}
{% else %}
  {% set image_size = 'image-size-small' %}
  {% set images = {
    1440: card__image__src|resizeWithGravity(293, 293),
    768: card__image__src|resizeWithGravity(174, 174),
    375: card__image__src|resizeWithGravity(200, 200),
  } %}
{% endif %}

{# Image #}
{% block card__img %}
  {% if card__image__src %}
    <div class="image-wrapper image-wrapper--{{ card_number_modifier }} {{ card_number_modifier }} {{image_size}}">
      <div class="image-background {{image_size}}">
      {% if card__link__url %}
        <a href="{{card__link__url}}" target="{{ card__link__new_window }}">
        {% else %}
          <div class="image-container">
      {% endif %}
      <div class="brand-shape">
        {{ brand_shape | raw }}
      </div>
        {% include "@atoms/images/image/responsive-image.twig" with {
          image_blockname: card__base_class,
          output_image_tag: card__image__output_image_tag,
          image_src: card__image__src|resizeWithGravity(433, 244),
          image_alt: card__image__alt,
          image_array: images,
        } %}
      {% if card__link__url %}
        </a>
        {% else %}
          </div>
      {% endif %}
      </div>
    </div>
  {% endif %}
{% endblock %}
{# Content #}
{# Heading #}
{% if card__heading.length > 0 %}
  {{ title_prefix }}
  {% set heading_link_attributes = {
    'target': card__link__new_window,
  } %}

 {#
 card__heading + space.
 https://dev.azure.com/MarsDevTeam/MarsExperiencePlatform/_workitems/edit/210929
 https://dev.azure.com/MarsDevTeam/MarsExperiencePlatform/_workitems/edit/290644
 #}
  {% include "@atoms/text/headings/_heading.twig" with {
    heading_base_class: card__heading__base_class|default('heading'),
    heading_modifiers: card__heading__modifiers,
    heading_blockname: card__base_class,
    heading_level: 2,
    heading: card__heading|brAfterFirstWord,
    heading_url: card__heading__link|default(card__link__url),
    heading_link_base_class: card__heading__link_base_class|default('heading-link'),
    heading_link_blockname: card__base_class,
    text_color_override: text_color_override,
    heading_link_attributes: heading_link_attributes,
    heading_extra_classes: card_number_modifier,
  } %}
  {{ title_suffix }}
  {% else %}
  {{ title_prefix }}
  {% set heading_link_attributes = {
    'target': card__link__new_window,
  } %}

 {#
 card__heading + space.
 https://dev.azure.com/MarsDevTeam/MarsExperiencePlatform/_workitems/edit/210929
 https://dev.azure.com/MarsDevTeam/MarsExperiencePlatform/_workitems/edit/290644
 #}
  {% include "@atoms/text/headings/_heading.twig" with {
    heading_base_class: card__heading__base_class|default('heading'),
    heading_modifiers: card__heading__modifiers,
    heading_blockname: card__base_class,
    heading_level: 2,
    heading: storybook_card__heading,
    heading_url: card__heading__link|default(card__link__url),
    heading_link_base_class: card__heading__link_base_class|default('heading-link'),
    heading_link_blockname: card__base_class,
    text_color_override: text_color_override,
    heading_link_attributes: heading_link_attributes,
    heading_extra_classes: card_number_modifier,
  } %}
  {{ title_suffix }}

{% endif %}
{# Subheading #}
{% if card__subheading %}
  {% include "@atoms/text/headings/_heading.twig" with {
    heading_base_class: card__subheading__base_class|default('subheading'),
    heading_modifiers: card__subheading__modifiers,
    heading_blockname: card__base_class,
    heading_level: 3,
    heading: card__subheading,
    heading_url: card__subheading__link,
    text_color_override: text_color_override,
    heading_extra_classes: card_number_modifier,
  } %}
{% endif %}
{# Body #}
{% if card__body %}
    {% include "@atoms/text/text/07-element.twig" with {
      paragraph_base_class: 'body',
      paragraph_blockname: card__base_class,
      paragraph_content: card__body,
      text_color_override: text_color_override,
      paragraph_extra_classes: card_number_modifier,
    } %}
{% endif %}
{# Link #}
{% if card__link__url and card__link__text %}
  <div class="cta-wrapper {{ card_number_modifier }}">
    {% set attr = {
      'href': card__link__url,
      'target': card__link__new_window,
    } %}
    {% include "@atoms/links/defaultLink/defaultLink.twig" with {
      default_link_content: card__link__text,
      default_link_attributes: attr
    } %}
  </div>
{% endif %}
{# Button #}
{% if card__button__url %}
  {% include "@atoms/buttons/twig/button.twig" with {
    button_base_class: card__button__base_class|default('button'),
    button_modifiers: card__button__modifiers,
    button_blockname: card__base_class,
    button_attributes: card__button__attributes,
    button_content: card__button__content,
    button_url: card__button__url,
    button_extra_classes: card_number_modifier,
  } %}
{% endif %}
