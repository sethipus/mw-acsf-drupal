{% set picture_base_class = picture_base_class|default('picture') %}

<picture
  {{ bem(picture_base_class, picture_modifiers, picture_blockname) }}
>
  {% if image_array %}
    {#
      Internet Explorer 9 doesn't recognise source elements that are wrapped in
      picture tags. See http://scottjehl.github.io/picturefill/#ie9
    #}
    <!--[if IE 9]><video style="display: none;"><![endif]-->
    {% for breakpoint, image in sources|reverse(true) %}
      {% if loop.first %}
        {% set first_image = breakpoint %}
      {% endif %}
      {% set media_string = "(max-width:" ~ breakpoint ~ "px)" %}
      {% if loop.last %}
        {% set media_string = "(min-width:769px)" %}
      {% endif %}
      <source media={{media_string}} srcset="{{image}}">
    {% endfor %}
  {% endif %}

  {# The controlling image, with the fallback image in srcset. #}
  {% include "@atoms/images/image/_image.twig" with {
    image_blockname: picture_blockname,
    image_base_class: picture_base_class,
    image_modifiers: picture_modifiers,
    image_src: image_src,
    image_alt: image_alt,
    image_title: image_title,
    image_array: []
  } %}

</picture>
